<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Metrax Leaderboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
  body {
    font-family: 'Inter', sans-serif;
    background-color: #0d1117;
    color: #ffffff;
  }

  .leaderboard-card {
    background-color: #161b22;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 0 10px #0ea5e9;
  }

  .neon-text {
    font-weight: 600;
    color: #3b82f6;
    text-shadow: 0 0 5px #3b82f6;
  }

  .avatar {
    border-radius: 9999px;
    width: 40px;
    height: 40px;
    object-fit: cover;
  }

  .table-header {
    font-weight: 600;
    text-transform: uppercase;
    color: #cbd5e1;
    font-size: 0.75rem;
  }

  .glow-box {
    background-color: #1f2937;
    border-radius: 0.75rem;
    padding: 1rem;
    margin-bottom: 0.75rem;
    border: 1px solid #3b82f6;
  }
</style>

<div class="max-w-5xl mx-auto mt-8">
  <h1 class="text-center text-4xl font-bold neon-text mb-10">LEADERSHIP BOARD</h1>

  <div class="grid grid-cols-8 gap-4 text-center table-header mb-4">
    <div>RANK</div>
    <div></div>
    <div>NAME</div>
    <div>FOCUS</div>
    <div>RESILIENCE</div>
    <div>SLEEP</div>
    <div>FITNESS</div>
    <div>HEART</div>
  </div>

  <div id="leaderboard" class="space-y-4"></div>
</div>

   <!-- scores -->   
<script>
  const API_KEY = 'patmCpxVe4M9Sbr7k.e07989b447f501528661d099d8ed046947fd31345fc6f6de4d99b49559dc38de';
  const BASE_ID = 'appwfMmuxK6Pu0JeR';
  const TABLE_NAME = 'Biomarker Scores';

  async function fetchLeaderboard() {
    const res = await fetch(`https://api.airtable.com/v0/${BASE_ID}/${encodeURIComponent(TABLE_NAME)}?sort[0][field]=Overall%20Score&sort[0][direction]=desc`, {
      headers: { Authorization: `Bearer ${API_KEY}` }
    });

    const data = await res.json();
    const leaderboard = data.records;
    const container = document.getElementById('leaderboard');
    container.innerHTML = '';

    leaderboard.forEach((record, i) => {
      const f = record.fields;
      const name = f.Alias || 'Anonymous';
      const focus = f['Energy & Focus Score'] ?? 'n/a';
      const resilience = f['Mental Resilience Score'] ?? 'n/a';
      const sleep = f['Sleep & Recovery Score'] ?? 'n/a';
      const fitness = f['Fitness Score'] ?? 'n/a';
      const heart = f['Heart & Metabolic Score'] ?? 'n/a';
      const image = f['Avatar URL'] || `https://api.dicebear.com/7.x/thumbs/svg?seed=${name}`;

      const html = `
        <div class="grid grid-cols-8 gap-4 items-center glow-box">
          <div class="text-xl font-bold text-blue-400">#${i + 1}</div>
          <div><img class="avatar" src="${image}" alt="${name}" /></div>
          <div class="font-semibold">${name}</div>
          <div>${focus}</div>
          <div>${resilience}</div>
          <div>${sleep}</div>
          <div>${fitness}</div>
          <div>${heart}</div>
        </div>
      `;
      container.insertAdjacentHTML('beforeend', html);
    });
  }

  fetchLeaderboard();
</script>

</body>
</html>
